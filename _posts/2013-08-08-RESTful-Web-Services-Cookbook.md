---
layout: post
---

#RESTful Web Services Cookbook#

[《RESTful Web Services Cookbook》](http://www.infoq.com/cn/minibooks/restful-web-services-cookbook-cn?utm_source=infoq&utm_medium=related_content_link&utm_campaign=relatedContent_articles_clk)

REST(表述性状态转移)是一种分布式应用架构。

##Chapter 1 使用统一接口##

HTTP是一种应用层协议，它定义了客户端与服务器之间的转移操作的表述形式。

###1.1 如何保持交互的可见性###

作为应用协议，HTTP的设计目标是在客户端和服务器之间保持对库、服务器、代理、缓存和其他工具的可见性。可见性是HTTP的一个核心特征。

HTTP通过以下途径来实现可见性：

- HTTP的交互是无状态的，任何HTTP中介都可以推断出给定请求和响应的意义，而无须关联过去或将来的请求和相应。
- HTTP使用一个统一接口，包括有OPTIONS, GET, HEAD, POST, DELETE和TRACE方法。接口中的每一个方法操作一个且仅有一个资源。每个方法的语法和含义不会因应用程序或资源的不同而发生改变。
- HTTP使用一种与MIME类似的信封格式进行表述编码。这种格式明确区分标头和内容。标头是可见的，除了创建、处理消息的部分，软件的其他部分都可以不用关心消息的内容。

###1.2 何时使用GET方法###

Web基础设施严重依赖于GET方法的幂等性和安全性。客户端期望能够重复发起GET请求，而不必担心造成副作用。缓存依赖于不需访问源服务器便能提供已缓存表述的能力。

###1.3 何时使用POST方法###

在以下场合中使用POST方法：

- 创建新的资源，把资源作为一个工厂；
- 通过一个控制器资源来修改一个或多个资源；
- 执行需要大数据输入的查询；
- 在其他HTTP方法看上去不合适时，执行不安全或非幂等的操作。

###1.4 如何使用POST方法创建资源###

资源创建之后，返回响应码201(Created)，并在Location头中包含新创建资源的URI。

###1.5 何时使用PUT方法创建新资源###

只有在客户端可以决定资源的URI时才使用PUT方法创建新资源，否则，使用POST。

当您支持使用PUT创建新资源的时候，客户端必须可以为资源指定URI，使用PUT方法创建新资源时，要考虑以下要点：

- 为了让客户端可以指定URI，服务器需要向客户端解释URI在服务器中是如何组织的，什么样的URI是合法的，以及什么样的URI是非法的。
- 您还要顾及所有设置于服务器端的基于URI模式的安全和过滤规则，这时您可能希望客户端在创建新资源时使用范围更小的URI。

通常情况下，任何使用PUT方法创建的资源，同样都可以在资源工厂中使用POST方法来创建。

##Chapter 2 识别资源##

开发RESTful Web服务的首要步骤之一就是设计资源模型。资源模型对所有客户端用来与服务器交互的资源加以识别和分类。资源模型并无所谓正确与否，重要的是您能否正确地使用HTTP的统一接口来实现您的Web服务。

###2.1 如何从领域名词中识别资源###

从您的用例找到可以用“创建”、“读取”、“更新”或“删除”动作来操作的领域名词。将每个领域名词都标识为资源。使用POST, GET, PUT和DELETE方法分别为每个资源实现“创建”，“读取”，“更新”和“删除”操作。

###2.2 如何选择资源的粒度###

可以通过网络效率、表述的多少以及客户端的易用程度来帮助确定资源的粒度。

那么，您应该如何确定哪些名词是候选资源呢？如何确定合适的粒度？回答这些问题最好的方式是从客户端的角度思考问题。

仔细设计资源粒度，以确保使用更多缓存，减小修改频率，或将不可变数据从使用缓存较小，修改频率更高或可变数据分离出来，这样可以改善客户端和服务器端的效率。

###2.3 如何将资源组织为集合###

将资源组织为集合，可以让客户端以及服务器将一组资源视为一个资源来引用，在集合上执行查询，甚至将集合作为工厂来创建新资源。

集合并不一定都要是分层的，一个给定的资源可以是多个集合资源的一部分。

###2.4 何时将资源合并为复合资源###

复合资源降低了统一接口的可见性，因为它们的表述中包含了和其他资源相重叠的数据，因此，在提供复合资源前，请考虑：

- 如果在应用程序中对复合资源的请求很少，那么它可能不是一个好的选择。依赖缓存代理，从缓存中获取这些资源，也许能让客户端受益匪浅。
- 网络开销-客户端与服务器之间的网络开销，服务器和后端服务或它所依赖的数据存储之间的网络开销。如果后者开销很大，那获取大量数据并在服务器上将它们组合成复合资源可能会增加客户端的延时，降低服务器的吞吐量。

##Chapter 3 设计表述##

客户端所关心的资源是一个抽象的实体，它是用URI来标识的。另一方面，表述是具体而真是的，您在客户端和服务器上针对它编写代码，进行操作。

###3.1 如何使用实体头来注解表述###

表述是一连串字节加上用于描述那些字节的元数据。